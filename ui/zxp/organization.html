<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		
		<link rel="stylesheet" href="../../css/theme.css" />
		
		<style type="text/css">
			.el-dropdown-link {
    cursor: pointer;
    color: #409EFF;
  }
  .el-icon-arrow-down {
    font-size: 12px;
  }
		</style>
	</head>
	<body>
<div id="app">
	<div class="row" style="margin-top: 20px;">
	&nbsp;&nbsp;
	</el-input>
	<el-input type="text" style="width: 400px;" placeholder="按姓名模糊查询" maxlength="10" v-model="empname" show-word-limit>
	</el-input>
		<el-button icon="el-icon-search" circle @click="page(1,3)"></el-button>
	 <el-button type="primary" round @click="add = true">添加员工</el-button>
	</div>
	<el-divider></el-divider>
	
	
	
	
	
			
			<el-row>
				<el-col :span="24">
			<el-table :default-sort="{prop: 'pdate', order: 'descending'}" :data="vehicleInfo.list" border :row-class-name="tableRowClassName"  >
						<el-table-column prop="uid" label="员工编号" style="color:#B3D8FF ;">	
						</el-table-column>
						<el-table-column  label="部门" style="color:#B3D8FF ;">
							<template slot-scope="temp">
									{{temp.row.depid  |changSex}}
							</template>
						</el-table-column>
						<el-table-column prop="rid" label="职位" style="color:#B3D8FF ;">
							<template slot-scope="temp">
									{{temp.row.rid  |changSex2}}
							</template>
						</el-table-column>
						<el-table-column prop="username" label="员工姓名" style="color:#B3D8FF ;">
						</el-table-column>
						<el-table-column prop="sex" label="性别" style="color:#B3D8FF ;">
						</el-table-column>
						<el-table-column prop="address" label="居住地址" style="color:#B3D8FF ;">
						</el-table-column>
						<el-table-column prop="comedate" label="入职时间" style="color:#B3D8FF ;">
						</el-table-column>
						<el-table-column label="操作" style="color:#B3D8FF ;"  width="175">
							<template slot-scope="scope">
								<el-button type="primary"   @click="update(vehicleInfo.list[scope.$index].uid)">编辑</el-button>
								<el-button type="primary"    @click="delOne(vehicleInfo.list[scope.$index].uid)">删除</el-button>
							</template>
						</el-table-column>
						
					</el-table>
					<el-pagination background prev-text="上一页" next-text="下一页" @size-change="sizec" @current-change="change" layout="total,sizes,prev, pager, next, jumper" :total="vehicleInfo.total" :page-sizes="[1,2,3,4,5]" :page-size="vehicleInfo.pageSize">
			</el-col>	
			</el-row>
	
	
	   
       		
   <el-dialog title="添加员工入职信息" :visible.sync="add" width="72%" :before-close="handleClose">
   	<span style="position: relative;left: -63px;">员工编号：</span><el-input type="text" style="width: 200px;margin-left: -60px;" placeholder="" id="uid" maxlength="20" v-model="formLabelAlign.uid"/>&nbsp;&nbsp;&nbsp;
   	员工姓名：<el-input type="text" style="width: 200px;" placeholder="" id="name" maxlength="20" v-model="formLabelAlign.username" />&nbsp;&nbsp;&nbsp;
	员工性别：
	<template>
  <el-radio v-model="formLabelAlign.sex" label="男">男</el-radio>
  <el-radio v-model="formLabelAlign.sex" label="女">女</el-radio>
</template>
		<br /><br />
		<span style="position: relative;left: 5px;">登录账号：&nbsp;</span>
		<el-input type="text" style="width: 200px;" placeholder=""  maxlength="20" v-model="formLabelAlign.user" />&nbsp;&nbsp;&nbsp; 
		登录密码：
		<el-input type="password" style="width: 200px;" placeholder=""  maxlength="20" v-model="formLabelAlign.pwd" />&nbsp;&nbsp;&nbsp; 
		居住地址：
		<el-input type="text" style="width: 200px;" placeholder="" id="address" maxlength="20" v-model="formLabelAlign.address" />&nbsp;&nbsp;&nbsp; 
		<br /><br />
		<span style="position: relative;left: 15px;">入职时间：&nbsp;</span>
	<el-date-picker v-model="formLabelAlign.comedate" type="date" placeholder="请选择入职日期" id="rtime" style="width: 200px;margin-left: 10px;">
	</el-date-picker>&nbsp; &nbsp; 员工部门：
		 <el-select v-model="formLabelAlign.depid" placeholder="请选择">
              <el-option
                v-for="item in options"
                :key="item.value"
                :label="item.label"
                :value="item.value"
                :disabled="item.disabled">
              </el-option>
          </el-select>
          &nbsp;&nbsp;&nbsp; 
		员工职位：
		 <el-select v-model="formLabelAlign.rid" placeholder="请选择">
              <el-option
                v-for="item in options1"
                :key="item.value"
                :label="item.label"
                :value="item.value"
                :disabled="item.disabled">
              </el-option>
          </el-select>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		<br /><br />
		联系方式：
		<el-input type="text" style="width: 200px;" placeholder=""  maxlength="20" v-model="formLabelAlign.phone" />&nbsp;&nbsp;&nbsp; 
		邮箱地址：
		<el-input type="text" style="width: 200px;" placeholder="" id="address" maxlength="20" v-model="formLabelAlign.email" />&nbsp;&nbsp;&nbsp; 
		<br />
		<br />
		<span slot="footer" class="dialog-footer" style="position: relative;left: -400px;">
   				 <el-button @click="add = false">取 消</el-button>
   				 <el-button type="primary" @click="addall">保存</el-button>
  				</span>
			</el-dialog>

	<el-dialog title="职工信息修改" :visible.sync="modify" width="72%" :before-close="handleClose">
				<span style="position: relative;left: -63px;">员工编号：</span><el-input type="text" style="width: 200px;margin-left: -60px;" placeholder="" id="uid" maxlength="20" v-model="formLabelAlign.uid"/>&nbsp;&nbsp;&nbsp;
   	员工姓名：<el-input type="text" style="width: 200px;" placeholder="" id="name" maxlength="20" v-model="formLabelAlign.username" />&nbsp;&nbsp;&nbsp;
	员工性别：
	<template>
  <el-radio v-model="formLabelAlign.sex" label="男">男</el-radio>
  <el-radio v-model="formLabelAlign.sex" label="女">女</el-radio>
</template>
		<br /><br />
		<span style="position: relative;left: 5px;">登录账号：&nbsp;</span>
		<el-input type="text" style="width: 200px;" placeholder=""  maxlength="20" v-model="formLabelAlign.user" />&nbsp;&nbsp;&nbsp; 
		登录密码：
		<el-input type="password" style="width: 200px;" placeholder=""  maxlength="20" v-model="formLabelAlign.pwd" />&nbsp;&nbsp;&nbsp; 
		居住地址：
		<el-input type="text" style="width: 200px;" placeholder="" id="address" maxlength="20" v-model="formLabelAlign.address" />&nbsp;&nbsp;&nbsp; 
		<br /><br />
		<span style="position: relative;left: 15px;">入职时间：&nbsp;</span>
	<el-date-picker v-model="formLabelAlign.comedate" type="date" placeholder="请选择入职日期" id="rtime" style="width: 200px;margin-left: 10px;">
	</el-date-picker>&nbsp; &nbsp; 员工部门：
		 <el-select v-model="formLabelAlign.depid" placeholder="请选择">
              <el-option
                v-for="item in options"
                :key="item.value"
                :label="item.label"
                :value="item.value"
                :disabled="item.disabled">
              </el-option>
          </el-select>
          &nbsp;&nbsp;&nbsp; 
		员工职位：
		 <el-select v-model="formLabelAlign.rid" placeholder="请选择">
              <el-option
                v-for="item in options1"
                :key="item.value"
                :label="item.label"
                :value="item.value"
                :disabled="item.disabled">
              </el-option>
          </el-select>&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; 
		<br /><br />
		联系方式：
		<el-input type="text" style="width: 200px;" placeholder=""  maxlength="20" v-model="formLabelAlign.phone" />&nbsp;&nbsp;&nbsp; 
		邮箱地址：
		<el-input type="text" style="width: 200px;" placeholder="" id="address" maxlength="20" v-model="formLabelAlign.email" />&nbsp;&nbsp;&nbsp;
		<br />
		<br />
		<span slot="footer" class="dialog-footer" style="position: relative;left: -400px;">
   				 <el-button @click="update = false">取 消</el-button>
   				 <el-button type="primary" @click="updates">保存</el-button>
  				</span>
			</el-dialog>

</div>
	</body>
	<script>var app = new Vue({
			el: '#app',
			data: {
				formLabelAlign:{
					uid:'',
					depid:'',
					rid:'',
					username:'',
					address:'',
					comedate:'',
					user:'',
					pwd:'',
					phone:'',
					email:'',
					sex: '',
				},
				add: false,
				modify:false,
				piges: {},
				carlist: [],
				list: [],
				vehicleInfo:[],
				stsy: [{
					name: '员工编号',
					value: 'uid'
				},{
					name: '部门',
					value: 'depid'
				}, {
					name: '职位',
					value: 'rid'
				}, {
					name: '员工姓名',
					value: 'username'
				}, {
					name: '性别',
					value: 'sex'
				}, {
					name: '居住地址',
					value: 'address'
				}, {
					name: '入职时间',
					value: 'comedate'
				}, {
					name: '操作',
					value: '0'
				}],
        options: [{
          value: '1',
          label: '维修部',

        }, {
          value: '2',
          label: '人事部',

        }, {
          value: '3',
          label: '客服部',

        }, {
          value: '4',
          label: '财务部',

        }, {
          value: '5',
          label: '仓库部',

        }, {
          value: '6',
          label: '系统部',

        }],
        value: '员工部门'
      ,
        options1: [{
          value: '1',
          label: '总经理',

        }, {
          value: '2',
          label: '前台经理',

        }, {
          value: '3',
          label: '售后经理',

        }, {
          value: '4',
          label: '仓库管理员',

        }, {
          value: '5',
          label: '人事经理',

        }, {
          value: '6',
          label: '前台顾问',

        }],
        value1: '员工职位'
			}
			,filters: {
     changSex(val) {
					var a=["维修部","人事部","客服部","财务部","仓库部","系统部"];
					return  a[val-1];
				},changSex2(val) {
					var a=["总经理","前台经理","售后经理","仓库管理员","人事经理","前台顾问"];
					return  a[val-1];
				}
   },
			methods: { 
				stringToDate(dateStr,separator){
     if(!separator){
            separator="-";
     }
     var dateArr = dateStr.split(separator);
     var year = parseInt(dateArr[0]);
     var month;                     
     if(dateArr[1].indexOf("0") == 0){
         month = parseInt(dateArr[1].substring(1));
     }else{
          month = parseInt(dateArr[1]);
     }
     var day = parseInt(dateArr[2]);
     var date = new Date(year,month -1,day);
     return date;
 },
				delOne(uid) {
					let _this = this;
					if(window.confirm('是否确定删除？')) {
						$.ajax(`http://localhost:8080/zxp/api/user/delete/${uid}`, {
							type: "delete",
							dataType: "json",
							success(msg) {
								if(msg.code == "200") {
									alert("删除成功");
									_this.page(1, 3);
								} else {
									alert("删除失败");
								}
							}
						});
					} 
				},
				/* formatRole: function(row, column) {
                return row.ud_status == '1' ? "维修部" : row.ud_status == '2' ? "人事部": row.ud_status == '3' ? "客服部": row.ud_status == '4' ? "财务部": row.ud_status == '5' ? "仓库部": row.ud_status == '6' ? "系统部";
            },*/
				page(n,s) {
					let _this = this;
					jQuery.getJSON(`http://127.0.0.1:8080/zxp/api/user/queryUserAll/${n}/${s}`,function(pg) {
						_this.vehicleInfo = pg;

						_this.list = pg.list;
						
					});
				},
				//页数改变事件

				change(num) {
					let _this = this;
					this.page(num, _this.vehicleInfo.pageSize);
				},
				//pageSize选择事件
				sizec(size) {
					this.page(1, size);
				},
				//添加数据
				addall() {
					let _this=this;
					jQuery.ajax("http://127.0.0.1:8080/zxp/api/user/add",{
						type:'post',
						data:JSON.stringify(_this.formLabelAlign),
						contentType: 'application/json; charset=UTF-8',
						success(data){
							if(data=="ok"){
								alert("新增失败！");
							}else{							
								alert("新增成功！");
									_this.add = false;
									_this.page(1, 3);
							}
						}
					});
				},updatea(uid) {
					let _this = this;
					$.getJSON(`http://127.0.0.1:8080/zxp/api/user/selectByIdt/${uid}`,
						function(data) {
							_this. formLabelAlign= data;
						}
					);
				},
				updates() {
					let _this = this;
					alert(JSON.stringify(_this.formLabelAlign));
					$.ajax("http://localhost:8080/zxp/api/user/updatetxl", {
						type: "put",
						contentType: "application/json",
						data: JSON.stringify(_this.formLabelAlign),
						dataType: "json",
						success(msg) {
							if(msg.code == "200") {
								alert('保存成功');
									_this. modify= false;
									_this.page(1, 3);
							} else {
								alert('保存失败');
							}
						}
					});
				},update(uid) {
					let _this = this;
					_this.modify = true;
					var a=["维修部","人事部","客服部","财务部","仓库部","系统部"];
					var aa=["总经理","前台经理","售后经理","仓库管理员","人事经理","前台顾问"];
					$.getJSON(`http://127.0.0.1:8080/zxp/api/user/selectById/${uid}`,
						function(data) {
							_this. formLabelAlign= data;
							_this. formLabelAlign.depid= a[data.depid-1];
							_this. formLabelAlign.rid= aa[data.rid-1];
						}
					);
				},
				updates() {
					let _this = this;
					$.ajax("http://localhost:8080/zxp/api/user/update", {
						type: "put",
						contentType: "application/json",
						data: JSON.stringify(_this.formLabelAlign),
						dataType: "json",
						success(msg) {
							if(msg.code == "200") {
								alert('保存成功');
									_this. modify= false;
									_this.page(1, 3);
							} else {
								alert('保存失败');
							}
						}
					});
				}
			},
			mounted() {
				let _this = this;
				_this.page(1, 3);
			}
		});
	</script>
<link rel="stylesheet" href="../../css/theme.css" />

</html>
