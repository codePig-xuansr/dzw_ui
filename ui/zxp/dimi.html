<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style type="text/css">
			#app{
				
				padding-left: 5px;
				padding-top: 20px;
			}
		</style>
	</head>
	<body>
<div id="app">
	<template>
		<el-input type="text" style="width: 300px;" placeholder="根据姓名模糊查询" v-model="empname" maxlength="10" show-word-limit>

	</template>
	<el-button icon="el-icon-search" circle @click="page(1,3)"></el-button>
	 <el-button type="primary" round @click="tianjializhi">添加离职</el-button>
	<br />
	<br />
	<template id="a2">
		<el-table :data="vehicleInfo" height="300" border style="width: 77%;margin-left: 150px;">
			<el-table-column prop="departmentname" label="部门" width="100">
				<el-input v-model="vehicleInfo.departmentname"></el-input>
			</el-table-column>
			<el-table-column prop="empid" label="员工编号" width="100">
				<el-input v-model="vehicleInfo.empid"></el-input>
			</el-table-column>

			<el-table-column prop="empname" label="员工姓名" width="100">
				<el-input v-model="vehicleInfo.empname"></el-input>
			</el-table-column>
			<el-table-column prop="empsex" label="性别" width="100">
				<el-input v-model="vehicleInfo.empsex"></el-input>
			</el-table-column>
			<el-table-column prop="postname" label="员工职位" width="100">
				<el-input v-model="vehicleInfo.postname"></el-input>
			</el-table-column>
			<el-table-column prop="dimissiontime" label="离职日期" width="100">
				<el-input v-model="vehicleInfo.dimissiontime"></el-input>
			</el-table-column>
			<el-table-column prop="dimissioncause" label="离职原因" width="100">
				<el-input v-model="vehicleInfo.dimissioncause"></el-input>
			</el-table-column>

			<el-table-column label="操作" width="180">
				<template slot-scope="temp">
					<!--<el-popover placement="top-start" title="标题：回滚" width="200" trigger="hover" content="恢复此员工的职位！" style="color: red;">
						<el-button slot="reference" style="background-color: cyan;" @click="open(temp.row.empid)">回滚</el-button>
					</el-popover>-->

					<el-button type="primary"   @click="modify = true">查看</el-button>
								<el-button type="primary"    @click="delOne(vehicleInfo.list[scope.$index].uid)" style="position: relative;float: 50px;">删除</el-button>

				</template>
			</el-table-column>
		</el-table>
	</template>
	<!--
		查询员工信息
    -->
    
	<el-dialog title="此员工资料信息如下:" :visible.sync="dialogVisiblee" width="68%" :before-close="handleClose" style="margin-top: -90px;">
		<el-divider></el-divider>
员工编号：
		<el-input type="text" style="width: 200px;" placeholder=""  v-model="empVo.empid" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp;  
		员工姓名：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empname" maxlength="20" show-word-limit/>
		员工性别：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empsex" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		<br /><br />
		员工账号：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.emptype" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		
		员工部门：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.payrollname" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		员工职位：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.postname" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		<br /><br />
		员工状况：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empcondition" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		员工身高：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empheight" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		员工学历：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empeducation" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		<br /><br />
		毕业学校：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empschool" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		员工专业：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empprofession" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		身份证号：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empcard" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp;
		<br /><br />
		居住地址：
		<el-input type="text" style="width: 200px;" placeholder=""  v-model="empVo.empaddress" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		联系方式：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.emptelephone" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		电子邮箱：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empemail" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp;
		<br /><br />
		入职时间：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empentrytime" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		出生日期：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empbirthtime" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		推荐人：&nbsp;&nbsp;&nbsp;
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.empreferrer" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp;
		<br /><br />
		员工门店：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.shopname" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		计薪方式：
		<el-input type="text" style="width: 200px;" placeholder="" v-model="empVo.payrollname" maxlength="20" show-word-limit/>&nbsp;&nbsp;&nbsp; 
		<el-divider></el-divider>
		<span slot="footer" class="dialog-footer">
    <el-button @click="dialogVisiblee = false">取 消</el-button>
    <el-button type="primary" @click="dialogVisiblee = false">确 定</el-button>
  </span>
	</el-dialog>
	
	
	
	
	
	
	
	

	<el-dialog title="添加员工离职信息" :visible.sync="dialogVisible" width="50%" :before-close="handleClose">
		离职编号：
		<el-input type="text" style="width: 200px;" placeholder="请输入离职编号" disabled="" v-model="suiji" maxlength="10" show-word-limit/>&nbsp;&nbsp;&nbsp; 离职原因：
		<el-input type="text" style="width: 200px;" placeholder="请输入离职编号" v-model="record.dimissioncause" maxlength="10" show-word-limit/>
		<br /><br />
		<template>
			员工姓名：
			<el-select v-model="record.empid" filterable placeholder="请选择" style="width: 200px;" id="sel">
				<el-option v-for="item in employee" :key="item.empname" :label="item.empname" :value="item.empid">

				</el-option>
			</el-select>
		</template>
		&nbsp;&nbsp;
		<template>
			<div class="block" style="display:inline-block">
				<span class="demonstration">离职日期：</span>
				<el-date-picker v-model="record.dimissiontime" type="datetime" placeholder="选择日期时间">
				</el-date-picker>
			</div>

		</template>

		<span slot="footer" class="dialog-footer">
    <el-button @click="dialogVisible = false">取 消</el-button>
    <el-button type="primary" @click="add">确 定</el-button>
  </span>
	</el-dialog>

	<template>

		<div class="block" style="margin-top: 20px;">
			<el-pagination v-if="pageInfo.total!=0" @size-change="handleSizeChange" @current-change="handleCurrentChange" :current-page="currentPage" :page-sizes="[3, 6, 9]" :page-size="pageInfo.pageSize" layout="total, sizes, prev, pager, next, jumper" :total="pageInfo.total">
			</el-pagination>
		</div>
	</template>
</div>
	</body>
	<script>var app = new Vue({
	el: "#app",
	data: {
		//employee:{},
		empVo:{},
		suiji:"",
		visible: false,
		currentPage: 1,
		pageInfo: [],
		empname: "",
		currentPage1: 5,
		currentPage2: 5,
		currentPage3: 5,
		currentPage4: 4,
		dialogVisible: false,
		dialogVisiblee:false,
		employee:  
        {
          
        },record:{
    		empid:"",
    		dimissionid:"",
    		dimissiontime:"",
    		dimissioncause:"",   				
    	},
      
		value: '',
		pickerOptions: {
			shortcuts: [{
				text: '今天',
				onClick(picker) {
					picker.$emit('pick', new Date());
				}
			}, {
				text: '昨天',
				onClick(picker) {
					const date = new Date();
					date.setTime(date.getTime() - 3600 * 1000 * 24);
					picker.$emit('pick', date);
				}
			}, {
				text: '一周前',
				onClick(picker) {
					const date = new Date();
					date.setTime(date.getTime() - 3600 * 1000 * 24 * 7);
					picker.$emit('pick', date);
				}
			}]
		},
		value1: '',
		value2: '',
		value3: '',
		vehicleInfo:[{
					departmentname:'财务部',
					empid:'1',
					postname:'经理',
					empname:'张三',
					empsex:'男',
					dimissiontime:'2020年3月9日',
					dimissioncause:'另谋他就'
				},{
				departmentname:'财务部',
					empid:'1',
					postname:'员工',
					empname:'李四',
					empsex:'男',
						dimissiontime:'2020年3月9日',
					dimissioncause:'工资太低'
				}],

	},
	methods: {
		handleSizeChange(size) {

			this.pageSize = size;

			this.page(this.currentPage, this.pageSize);
		},
		handleCurrentChange(currentPage) {
			this.currentPage = currentPage;

			this.page(this.currentPage, this.pageInfo.pageSize);
		},
		handleClose(done) {
			this.$confirm('确认关闭？')
				.then(_ => {
					done();
				})
				.catch(_ => {});
		},
		page(p, s) {
			let _this = this;
			jQuery.getJSON(`http://127.0.0.1:8080/api/dimissions/dim/${p}/${s}/${_this.empname}`, function(list) {

				_this.pageInfo = list;
			})

		},
		open(empid) {
			let _this=this;
			
			this.$confirm('此操作将此员工恢复职位, 是否继续?', '提示', {
				confirmButtonText: '确定',
				cancelButtonText: '取消',
				type: 'warning'
			}).then(() => {
				jQuery.ajax(`http://127.0.0.1:8080/api/dimissions/dimi/${empid}`,{
						type:'delete',
						success(data){
							if(data.code=="200"){
								
								_this.page(1,3);
								
							}
						}
					})
				this.$message({
					type: 'success',
					message: '恢复成功!'
				});
			}).catch(() => {
				this.$message({
					type: 'info',
					message: '已取消删除'
				});
			});
		},openn(empid) {
			let _this=this;
			
			this.$confirm('此操作将删除此员工所有信息, 是否继续?', '提示', {
				confirmButtonText: '确定',
				cancelButtonText: '取消',
				type: 'warning'
			}).then(() => {
				jQuery.ajax(`http://127.0.0.1:8080/api/dimissions/dimission/${empid}`,{
						type:'delete',
						success(data){
							if(data.code=="200"){
								
								_this.page(1,3);
							}
						}
					})
				jQuery.ajax(`http://127.0.0.1:8080/api/dimissions/dimi/${empid}`,{
						type:'delete',
						success(data){
							if(data.code=="200"){
								
								_this.page(1,3);
								
							}
						}
					})
				this.$message({
					type: 'success',
					message: '删除成功!'
				});
			}).catch(() => {
				this.$message({
					type: 'info',
					message: '已取消删除'
				});
			});
		},showName(){
    				let _this=this;
    				jQuery.getJSON(`http://127.0.0.1:8080/api/dimissions/dimission`,function(list){
    					
    					_this.employee=list;
    				})
    				
   		 },add(){
    			let _this=this;
  					_this.dialogVisible = false
  				
  				_this.record.dimissionid=_this.suiji;
   			    jQuery.ajax(`http://127.0.0.1:8080/api/dimissions/dimission`,{
					  	type:'post',
					  	dataType:'json',
					  	contentType:'application/json',
						data:JSON.stringify(_this.record),
						success(data){
							if(data.code=="200"){
								alert("离职成功！")
								
								_this.page(1,3)
							}
						}
					  	
					  })

    		},tianjializhi(){
    			
    			let _this=this;
    			_this.suiji=Math.round(Math.random()*10000); 
    			_this.dialogVisible = true;
    		},chaxun(empid){
    			let _this=this;  			
    			_this.dialogVisiblee = true;
    			jQuery.getJSON(`http://127.0.0.1:8080/api/dimissions/dimission/${empid}`,function(data){
    					
    					_this.empVo=data;
    					
    				})
    			
    		}

	},
	mounted() {
		let _this = this;
		
		_this.page(1, 3);
		_this.showName();
	}

})</script>
</html>
	